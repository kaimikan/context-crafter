<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Context Crafter GUI</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <main class="container">
      <header>
        <h1>Context Crafter GUI</h1>
        <p>
          Select project folders and choose files to generate a context prompt
          for your AI assistant.
        </p>
        <div class="header-buttons">
          <button id="presets-btn" class="header-button">‚öôÔ∏è Presets</button>
          <button id="help-btn" class="header-button">? Help</button>
        </div>
      </header>

      <section class="step">
        <h2><span class="step-number">1.</span> Select Project Folders</h2>
        <div class="controls view-controls">
          <button id="expand-all-btn">Expand All</button>
          <button id="collapse-all-btn">Collapse All</button>
          <div class="toggle-switch">
            <input
              type="checkbox"
              id="show-only-highlighted-toggle"
              class="show-only-highlighted-toggle"
            />
            <label for="show-only-highlighted-toggle"
              >Only show highlighted</label
            >
          </div>
          <div class="toggle-switch">
            <input
              type="checkbox"
              id="show-only-included-toggle"
              class="show-only-included-toggle"
            />
            <label for="show-only-included-toggle">Only show included</label>
          </div>
          <div class="mass-action-controls">
            <span style="font-weight: bold; margin-right: 5px"
              >For Highlighted:</span
            >
            <button id="mass-action-full">Set Full</button>
            <button id="mass-action-path">Set Path</button>
            <button id="mass-action-ignore">Set Ignore</button>
          </div>
        </div>
        <div class="controls search-section">
          <h2 style="margin: 0; border: none; font-size: 1.1em">
            Highlight Files
          </h2>
          <input
            type="text"
            id="search-input"
            placeholder="Enter text to find in files..."
          />
          <button id="search-btn">Search</button>
          <button id="clear-search-btn">Clear</button>
        </div>
        <div class="panels-container">
          <div class="panel" id="panel-left">
            <input
              type="text"
              class="panel-title"
              placeholder="e.g., Frontend"
            />
            <div class="panel-buttons">
              <button class="select-dir-btn" data-panel-index="0">
                Select Folder
              </button>
              <button
                class="refresh-dir-btn"
                data-panel-index="0"
                style="display: none"
              >
                üîÑ Refresh
              </button>
            </div>
            <div class="file-tree-container" data-panel-index="0">
              <p class="placeholder">Left panel is empty...</p>
            </div>
          </div>
          <div class="panel" id="panel-right">
            <input
              type="text"
              class="panel-title"
              placeholder="e.g., Backend"
            />
            <div class="panel-buttons">
              <button class="select-dir-btn" data-panel-index="1">
                Select Folder
              </button>
              <button
                class="refresh-dir-btn"
                data-panel-index="1"
                style="display: none"
              >
                üîÑ Refresh
              </button>
            </div>
            <div class="file-tree-container" data-panel-index="1">
              <p class="placeholder">Right panel is empty...</p>
            </div>
          </div>
        </div>
      </section>

      <section class="step">
        <h2>
          <span class="step-number">2.</span> Add Specific Files (Optional)
        </h2>
        <div class="additional-files-controls">
          <button id="add-files-btn">Add Files</button>
        </div>
        <ul id="additional-files-list"></ul>
      </section>

      <section class="step">
        <h2><span class="step-number">3.</span> Describe Your Task</h2>
        <input
          type="text"
          id="task-desc"
          placeholder="e.g., Connect the login form to the auth endpoint"
        />
      </section>

      <section class="step">
        <h2><span class="step-number">4.</span> Generate & Copy Context</h2>
        <div class="generate-copy-buttons">
          <button id="generate-btn">Generate Context</button>
          <div class="output-toolbar">
            <button id="copy-btn">Copy to Clipboard</button>
            <span id="token-count">Tokens: 0</span>
          </div>
        </div>
        <textarea
          id="output-context"
          readonly
          placeholder="The final context for your prompt will be generated here..."
        ></textarea>
      </section>
    </main>

    <div id="presets-modal" class="modal">
      <div class="modal-content">
        <span class="modal-close-btn">&times;</span>
        <h3>Presets & Configuration</h3>
        <div class="preset-file-management">
          <button id="load-presets-btn">Load Presets from File</button>
          <button id="save-presets-btn">Save Presets to File</button>
          <span id="presets-file-status">No presets file loaded.</span>
        </div>
        <hr />
        <div class="presets-container">
          <div class="preset-group">
            <label for="preset-prompt-select"
              ><strong>Preset Prompts:</strong></label
            >
            <select id="preset-prompt-select"></select>
            <textarea
              id="preset-prompt-text"
              placeholder="Enter a prompt rule..."
            ></textarea>
            <div class="preset-controls">
              <button id="save-prompt-btn">Save</button>
              <button id="delete-prompt-btn">Delete</button>
            </div>
          </div>
          <div class="preset-group">
            <label for="project-preset-select"
              ><strong>Pre-defined Projects:</strong></label
            >
            <select id="project-preset-select"></select>
            <div class="preset-controls">
              <button id="save-project-btn">Save Current Folders</button>
              <button id="load-project-btn">Load Selected Project</button>
              <button id="delete-project-btn">Delete Selected</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="help-modal" class="modal">
      <div class="modal-content">
        <span class="modal-close-btn">&times;</span>
        <h3>How to Use Context Crafter</h3>
        <ul>
          <li>
            <strong>Presets:</strong> Use the "‚öôÔ∏è Presets" button to load, save,
            and manage your configurations in a JSON file.
          </li>
          <li>
            <strong>Select Folders:</strong> Click "Select Folder" to load a
            project folder.
          </li>
          <li>
            <strong>Refresh Folder:</strong> If you change files externally,
            click "Refresh".
          </li>
          <li>
            <strong>Add Specific Files:</strong> Use this section to include any
            individual files from outside your main project folders.
          </li>
          <li>
            <strong>Choose Files:</strong> Click icons to include content (üìù),
            path only (üîó), or ignore (‚ùå). Clicking an active icon again will
            ignore it.
          </li>
          <li><strong>Describe Your Task:</strong> Explain your goal.</li>
          <li>
            <strong>Generate & Copy:</strong> Compile everything and copy it to
            your clipboard.
          </li>
        </ul>
      </div>
    </div>

    <script src="script.js"></script>
  </body>
</html>
